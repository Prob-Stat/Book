# 確率変数と確率分布

## 確率変数

確率空間の上の様々な部分集合の確率を調べたい。
そのためには確率変数を導入すると便利である。

::: {#def-rv}
## 確率変数

確率空間 $(\Omega,\, P)$ について、
関数 $X\colon \Omega\to\mathbb{R}$ を**確率変数**という。

また、任意の $A\subseteq\mathbb{R}$ について
$$
\Pr(X\in A) \coloneqq P(\{\omega\in\Omega\mid X(\omega)\in A\})
$$
と定義する。
さらに、任意の $a\in\mathbb{R}$ について
$$
\Pr(X\ge a) \coloneqq P(X\in \{x\in\mathbb{R}\mid x\ge a\}) = P(\{\omega\in\Omega\mid X(\omega)\ge a\})
$$
と定義する。
同様に $\Pr(X > a),\, \Pr(X \le a),\, \Pr(X < a),\, \Pr(X = a)$ なども定義される。
:::

::: {.callout-note}
本当の確率論では確率変数は「確率空間から位相空間への写像で開集合の逆像が可測集合になるような関数」として定義される。
また、文献によっては確率変数は「確率空間から可測空間への写像で可測集合の逆像が可測集合になるような関数」として定義されることもある。
開集合族が生成する完全加法族をボレル集合族と呼ぶが、この方法で位相空間から可測空間を作ることができる。
そうすると前者の定義は「確率空間から位相空間への写像でボレル集合の逆像が可測集合になるような関数」と等価なので、後者の定義に含まれる。
後者の定義の中の可測空間が位相空間由来のものに限定したのが前者の定義であると言える。
:::

任意の関数 $f\colon \mathbb{R}\to\mathbb{R}$ について $f\circ X$ は確率変数である。
このとき、$\Pr(f\circ X \in A)$ と書く代わりに $\Pr(f(X)\in A)$ と書く。

::: {.callout-note}
本当の確率論の言葉で述べると任意のボレル関数(開集合(ボレル集合としても等価)の逆像がボレル集合となる関数) $f$ について $f\circ X$ は確率変数である。
:::

共通の確率空間 $(\Omega,\, P)$ 上の確率変数 $X,\,Y$ についてその和 $X + Y$ や積 $XY$ も確率変数である。

## 確率分布

確率変数 $X$ の像が高々可算のとき、$X$ を**離散型確率変数**という。
離散型確率変数でない確率変数を**連続型確率変数**という。

$X$ が離散型確率変数のとき、$A$ を $X$ の像の部分集合とすると

\begin{align*}
\Pr(X\in A) &= \Pr\left(\{\omega\in\Omega\mid X(\omega)\in A\}\right)\\
&= \Pr\left(\bigcup_{x\in A} \{\omega\in\Omega\mid X(\omega)=x\}\right)\\
&= \sum_{x\in A} \Pr\left(\{\omega\in\Omega\mid X(\omega)=x\}\right)\\
&= \sum_{x\in A} \Pr\left(X=x\right)
\end{align*}

であるので、

$$
f_X(x) \coloneqq \Pr(X=x) \qquad \forall x\in\mathbb{R}
$$

という関数を用いて
$$
\Pr(X\in A) = \sum_{x\in A} f_X(x)
$$
と表せる。
この $f_X(x)$ を**確率質量関数**という。

$X$ が連続型確率変数のとき、

\begin{align*}
\Pr(X\in A) &= \int_{x\in A} f_X(x) \mathrm{d}x
\end{align*}

が存在するとき、この $f_X(x)$ を**確率密度関数**という。
しかし、確率密度関数は常に存在するとは限らない。

例えば



## 確率分布の例

### 二項分布

二項分布の確率質量関数は

```{python}
#| label: fig-binom
#| fig-cap: "二項分布の確率質量関数"

import matplotlib.pyplot as plt
import numpy as np
from scipy.stats import binom

# パラメータの設定
n = 12       # 試行回数
p = 0.6      # 成功確率

# 取りうる値の範囲
x = np.arange(0, n+1)

# 二項分布のPMFの計算
pmf = binom.pmf(x, n, p)

# プロット
plt.figure(figsize=(8, 5))
plt.bar(x, pmf, tick_label=x)
plt.title(f'Pmf of binomial distribution with n={n}, p={p}')
plt.xlabel('$k$')
plt.ylabel('$\\Pr(X=k)$')
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()
```
